<div class="container mt-4" #formularioCombos>
  <h2>{{ editar ? 'Editar Combos' : 'Agregar Combos' }}</h2>

  <form (ngSubmit)="guardar(formCombos)" #formCombos="ngForm" novalidate>
    <div class="row">
      <!-- Nombre -->
      <div class="col-md-4 mb-2">
        <input 
          class="form-control" 
          type="text" 
          placeholder="Nombre" 
          [(ngModel)]="combo.nombre" 
          name="nombre" 
          required 
          #nombre="ngModel" 
          [ngClass]="{'is-invalid': nombre.invalid && nombre.touched}">
      </div>

      <!-- Balas -->
      <div class="col-md-4 mb-2">
        <input 
          class="form-control" 
          type="number" 
          placeholder="Balas" 
          [(ngModel)]="combo.incluyeBalas" 
          name="incluyeBalas" 
          required 
          #incluyeBalas="ngModel" 
          [ngClass]="{'is-invalid': incluyeBalas.invalid && incluyeBalas.touched}">
      </div>

      <!-- Tiempo -->
      <div class="col-md-4 mb-2">
        <input 
          class="form-control" 
          type="number" 
          placeholder="Tiempo" 
          [(ngModel)]="combo.tiempo_min" 
          name="tiempo_min" 
          required 
          #tiempo_min="ngModel" 
          [ngClass]="{'is-invalid': tiempo_min.invalid && tiempo_min.touched}">
      </div>

      <!-- Jugadores -->
      <div class="col-md-4 mb-2">
        <input 
          class="form-control" 
          type="number" 
          placeholder="Jugadores" 
          [(ngModel)]="combo.jugadores" 
          name="jugadores" 
          required 
          #jugadores="ngModel" 
          [ngClass]="{'is-invalid': jugadores.invalid && jugadores.touched}">
      </div>

      <!-- Precio -->
      <div class="col-md-4 mb-2">
        <input 
          class="form-control" 
          type="number" 
          placeholder="Precio" 
          [(ngModel)]="combo.precio" 
          name="precio" 
          required 
          #precio="ngModel" 
          [ngClass]="{'is-invalid': precio.invalid && precio.touched}">
      </div>
    </div>

    <!-- Botones -->
    <button 
      type="submit" 
      class="btn btn-primary me-2" 
      [disabled]="formCombos.invalid">
      <mat-icon>{{ editar ? 'edit' : 'add' }}</mat-icon>
      {{ editar ? 'Actualizar' : 'Agregar' }}
    </button>

    <button 
      type="button" 
      class="btn btn-secondary" 
      *ngIf="editar" 
      (click)="editarCombosCancelar(formCombos)">
      <mat-icon>close</mat-icon> Cancelar
    </button>
  </form>

  <hr class="my-4" />

  <!-- Buscador -->
  <mat-form-field appearance="fill" class="w-100">
    <mat-label>Buscar</mat-label>
    <input matInput (keyup)="applyFilter($event)" placeholder="Buscar combo...">
  </mat-form-field>

  <!-- Tabla -->
  <div class="table-responsive">
    <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8 w-100">

      <!-- ID -->
      <ng-container matColumnDef="idCombo">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>ID</th>
        <td mat-cell *matCellDef="let c">{{ c.idCombo }}</td>
      </ng-container>

      <!-- Nombre -->
      <ng-container matColumnDef="nombre">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Nombre</th>
        <td mat-cell *matCellDef="let c">{{ c.nombre }}</td>
      </ng-container>

      <!-- Balas -->
      <ng-container matColumnDef="incluyeBalas">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Balas</th>
        <td mat-cell *matCellDef="let c">{{ c.incluyeBalas }}</td>
      </ng-container>

      <!-- Tiempo -->
      <ng-container matColumnDef="tiempo_min">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Tiempo</th>
        <td mat-cell *matCellDef="let c">{{ c.tiempo_min }}</td>
      </ng-container>

      <!-- Jugadores -->
      <ng-container matColumnDef="jugadores">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Jugadores</th>
        <td mat-cell *matCellDef="let c">{{ c.jugadores }}</td>
      </ng-container>

      <!-- Precio -->
      <ng-container matColumnDef="precio">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Precio</th>
        <td mat-cell *matCellDef="let c">{{ c.precio }}</td>
      </ng-container>

      <!-- Acciones -->
      <ng-container matColumnDef="acciones">
        <th mat-header-cell *matHeaderCellDef>Acciones</th>
        <td mat-cell *matCellDef="let c">
          <div class="d-flex gap-1">
            <button class="btn btn-warning btn-sm me-1" (click)="editarCombos(c)">
              <mat-icon class="me-1">edit</mat-icon>
            </button>
            <button class="btn btn-danger btn-sm" (click)="delete(c)">
              <mat-icon class="me-1">delete</mat-icon>
            </button>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="mostrarColumnas"></tr>
      <tr mat-row *matRowDef="let row; columns: mostrarColumnas;"></tr>
    </table>

    <mat-paginator [pageSizeOptions]="[5, 10, 25]" showFirstLastButtons></mat-paginator>
  </div>
</div>
